---
tags:
  - maths
---

# 1. 视(相机)空间下的切线与法线

## 1.1 切线的变换

切线的变换矩阵与顶点相同都是矩阵$M=Mw*Mv;$ 原因是由于切线的本质是两个顶点相减，两顶点经过同样变换后其差仍在同一方向上。eg: $(1,0)(0,1)$和原点构成的三角形斜边切线$T=(-1,1)$,假设$y$轴缩放一倍变为$(0,2)$,$T$的$y$轴也缩放一倍变为$(-1,2)$仍然是与两点形成的平面平行。

## 1.2 法线的变换

由于法线是与切线垂直是通过$N.Dot(T) = 0$计算出来的因此不能保证经过空间变换后法线仍然与切线垂直，如上述例子中所述三角形斜边的法线变换前为$(1,1)$经过$y$轴缩放后向量$(1,1)$变为$(1,2)$,此时的法线语言切线$(-1,2)$已经不垂直了。如下图:

![[Pic_024.png]]

# 2. 法线的变换矩阵

定义矩阵$M=Mworld * Mview$,由上述推导可知切线T的变换矩阵为$M$即  $T1 = T *M$假设法线的变换矩阵为$G$则 $N1 = N*G$，由于法线与切线是垂直的所以 $N1 * T1 = (N*G)Dot(T*M) = 0$  // eg$(1,1,0)dot(-1,1,0) = 0$ 可以写为$(1,1,0)*(-1,1,0)^t$看作$1*3$的矩阵与$3*1$矩阵的乘积。所以：$(N*G)Dot(T*M) = (N*G)t * (T*M) = Gt*Nt*T*M = 0$因为$NDot(T) = Nt*T = 0$ 所以：$Gt*Nt*T*M = Nt*T$ 所以可以推导出 $Gt*M = I$ 因此： $G = （M-1)^t$。

# 3. 总结

- 切线从本地空间转换到相机空间的变换矩阵与顶点相同都是$Mwolrd * Mview$
- 法线从本地空间切换到相机空间的变换矩阵为顶点变换矩阵逆矩阵的转置矩阵即 $((Mworld * Mview)-1)^t$
- 该推导结论在Shader中经常使用
---
tags:
  - maths
---

# 1. 点到图元的最短距离(投影)

## 1.1 概述

图形学中经常用到点在图元上的投影，这个投影其实就是这个点到这个图元最近的映射点，由这个投影点可以直接做差求出点到这个图元的最近距离。

## 1.2 点在面(3D)/直线(2D)上的投影

在此以3D空间为示例，2D直接降维使用即可。由之前平面的定义可知平面上任一点$p$ 与法向量的点积 $pn=d$,要计算任意点q在该平面的投影，可以在q点建立于该平面平行的辅助平面 $qn=d1$,由于两平面平行所以平面距离为$d-d1=d-qn=>q + (d-d1)n = q1$  $q1$为任意点$q$在平面上的投影因此$q1=q+(d-qn)n$。

## 1.3 点在球(3D)/圆(2D)上的投影

此处仍然以3D空间的球形为示例，结论圆形直接降维使用即可。假设球的中心点为$c$半径为r任一点为$p$，则$p$在该球面上的投影一定在$p$和$c$的连线上且距离球心c的距离为$r$因此可以轻松计算出任意点$q$在球面上的投影$q1 = q +((|(q-c)| - r)/|(q-c)| ) * (q-c)$。

## 1.4 点到AABB包围盒的投影

对于任意点$q$在$AABB$包围盒上的最近点的计算可以逐个轴于$p$点的分量比较eg：```if(px<minX) x= minX elseif(px >maxX) x = maxX```,如此计算每个轴向即可得出最近的投影点。

# 2. 相交性检测

相交性检测的本质是对同时满足两个(如直线和平面)图元的数学表达式组成的方程组求解。

## 2.1 两射线相交性检测

射线可以以用 $r(t)=p+dt$ ($p$为起点坐标$d$为射线方向，$t$为参数距离)。   两条射线可以用$r1(t1)=p1+dt1$    $r2(t2)=p2+dt2$  表示  两射线相交的含义是存在$t1,t2$同时满足以上两个方程 代入求解可以得出$t1 =((p2-p1)*d2)*(d1*d2) / |d1*d2|*|d1*d2|$   当$d1*d2$为0时$t1$非法表示此时没有交点，$d1*d2$为0表示两射线方向相同。

## 2.2 其他类型的相交检测

 对于可以抽象为方程式的几何图元可以直接采用方程组的方式计算相交点，对于无法抽象为方程式的图元如AABB就要简化为子图元如平面后在做计算。

# 3. 总结

- 无论是投影还是相交本质上都是对图元抽象的方程式的联合计算
- 最重要的技巧是拆解图元到对应的方程式
---
tags:
  - maths curves
---

# 1. 曲线概述

在图形学或者游戏编程中我们经常用到曲线，如：某物体沿曲线运动或者某效果的参数值按照曲线变化。本章将介绍常用的曲线内容。

# 2. 参数多项式曲线

## 2.1 概念

所谓参数多项式曲线，顾名思义就是指可以通过具有独立参数的函数描述的曲线就是参数多项式曲线。eg:  $y = (1 - x²)½$表示半径为1的圆

## 2.2 多项式曲线

多项式曲线是指曲线函数可以写为如下多项式形式的函数：

![[Pic_127.png]]

在图形学或者实际游戏开发中，更多的时候我们并不知道具体曲线的多项式函数，而是通过其他方式反向模拟计算出该多项式函数(eg: [[21. 贝塞尔曲线]])后续介绍。

***注：图形学中以三阶多项式函数的使用率最高，我们以此函数：$P(t)=c0+c1*t+c2*t²+c3*t³$为讨论重点***

## 2.3 矩阵形式

当$P(x)$函数扩展到二维/三维空间时，曲线方程变为：$X(t)=c10+c11*t+c12*t²+c13*t³ Y(t)=c20+c21*t+c22*t²+c23*t³$ 这样的形式，因此为了方便也会将曲线函数写成矩阵的形式：

![[Pic_195.png]]

***注：如果我们将t看做曲线段的进度信息(时间)，则$t=0$是为曲线的开始点t=1时未曲线段的终点。由此可知曲线段开始位置为$P(0) = c0$，曲线终点为$P(1)=c0+c1+c2+c3$。***

## 2.4 速度/加速度(曲线斜率)

由微积分的只是可知对曲线求导描述的是曲线的斜率(如果t表示含义是时间则斜率就是速度)，对斜率再次求导则是曲线的曲率即斜率变化率(如果t表示的含义是时间则二次求导的含义是在此时刻的加速度)

![[Pic_196.png]]

# 3. 插值与曲线

**多项式差值:** 以上所有论述均是在已知多项式曲线函数的基础上进行的，但在图形学中可能更多遇到的情况是需要通过一系列的经过点构造出一个对它们(这些经过点)差值的多项式函数

# 4. 由经过点和艾肯特算求曲线

## 4.1 艾肯特算法求多项式函数

该算法的基本原理是将复杂问题拆为多个简单问题分别处理。具体到用N个经过点确定一条曲线的方法就是：将第1到N-1的经过点确定的曲线与第2到第N个经过点确定的曲线进行融合得出此曲线的方式。

## 4.2 艾肯特算法示例

我们假设希望由三个经过点计算曲线。( 四个经过点时可以看做两个三经过点曲线的融合，五个经过点......)我们令yⁿm表示从第m个经过点开始到m+n个经过点之间的曲线方程。如下图：

![[Pic_197.png]]
![[Pic_198.png]]

***注：艾肯特算法的好处是易于实现，但是坏处也很明显他的本质是对经过点的直线的多次曲线化的模拟，可能与真实的曲线就较大出入。***

# 5. 由拉格朗日插值法求曲线

## 5.1 引入原因

由于艾肯特算法得出来的曲线与真实曲线可能有较大误差，因此在对曲线有较高要求是不能使用此方式。对于$N$个经过点的曲线我们当然可以通过设定$N-1$阶曲线方程($N-1$个曲线方程就有$N$个参数如:三阶方程$P(t)=c0+c1*t+c2*t²+c3*t³$有$c0,c1,c2,c3$四个方程参数)并将经过点代入方程构成方程组算出方程变量$c0~c3$，如下图示例，但就计算机图形学来说这个计算消耗太大。因此需要引入拉格朗日差值发的算法来计算曲线方程。

![[Pic_199.png]]

## 5.2 拉格朗日插值法

拉格朗日插值法的基本原理是将过N个经过点的曲线分解成了N条曲线之和$(F(x)=c0+c1*x+c2*x²+c3*x³+....+Cnx的n次方$)。此处为了方便理解我们先假定$N =3$，理解原理后在将N扩展到任意值都可以。假定我们知道三个点($x1, y1)，(x2, y2),(x3, y3)$由拉格朗日的思想可以将过这三个点的曲线看作三条曲线之和，三条曲线分别：$f1(x)$该曲线在$x=x1$时为$1$，$x = x2, x= x3$是均为$0$。$f2(x)$该曲线在$x=x2$时为$1$，$x = x1, x= x3$是均为$0$。$f3(x)$该曲线在$x=x3$时为$1$，$x= x1, x= x2$是均为$0$。拉格朗日发现把各曲线叠加融合之后得到的就是最终的曲线多项式： $P(x) = y1*f1(x)+ y2*f2(x) +y3*f3(x)$。(之所以用$y1,y2,y3$乘以对应值就是为了对三个曲线缩放后保证过最初的三个点$(x1, y1)，(x2, y2),(x3, y3))$推导出在$x1$为$1 x2,x3$为0的f1(x)函数多项式很简单：$f1(x) = (x-x2)*(x-x3)/(x1-x2)*(x1-x3)$。我们将$f1(x)$扩展到此示例中的三个维度则有：

![[Pic_200.png]]

因此由拉格朗日插值法反推出的曲线方程如下：

![[Pic_201.png]]

## 5.3 拉格朗日插值法示例

由以上拉格朗日插值法公式我们试着计算一个过四个点的曲线，四个点分布式$p1(0,2),p2(1/3,3),p3(2/3,2),p4(1,3)$，第一步计算四个子曲线方程$f1(x)=((x-x2)/(x1-x2)) * ((x-x3)/(x1-x3)) * ((x-x4)/(x1-x4)) = ((x-1/3)/(0-1/3)) * ((x-2/3)/(0-2/3)) * ((x-1)/(0-1))$同样的方式可以求出$f2(x), f3(x), f4(x)$ 最终的曲线方程： $P(x) = y1 *f1(x) + y2 * f2(x) + y3 * f3(x) + y4 *f4(x)$

# 6. 总结

- **图形学中的曲线经常使用多项式函数来表示曲线方程，但并非所有曲线都可以用多项式函数表示。如：圆的方程式。**
- **图形学/游戏中更多的情况并不知道曲线方程，反而是通过几个曲线经过的****经过点****来反向求曲线方程**
- **常用根据****经过点****求曲线方程由两种方式：艾肯特算法和拉格朗日插值算法**
- **艾肯特算法本质上是将N个点简化为两个N-1曲线叠加融合，在将N-1个点简化为两个N-2曲线叠加融合，直到N-M表示的是条直线。该做法简单性能高，计算出的曲线保证通过N个点，但计算出的曲线与实际真是的曲线误差度较高。**
- **拉格朗日插值法本质上是将N个点简化为N条固定样式曲线的叠加曲线样式符合拉格朗日多项式**
   ![[Pic_202.png]]  
   **最终的曲线是多条拉格朗日多项式曲线的叠加**
   ![[Pic_203.png]]
   **其好处是模拟的真实度高(完全一致的真实曲线)，坏处是性能消耗相对较高。**